<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to CAD - AI-Powered 3D Model Generator</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <!-- Three.js for 3D rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- OrbitControls for camera manipulation -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <!-- occt-import-js for STEP file loading -->
    <script src="https://cdn.jsdelivr.net/npm/occt-import-js@0.0.12/dist/occt-import-js.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>Text to CAD</h1>
            <p>Describe your 3D model in plain English</p>
        </header>

        <!-- Main content area -->
        <div class="main-content">
            <!-- Chat Panel -->
            <div class="chat-panel">
                <div class="panel-header">
                    <h2>Chat</h2>
                    <button id="clear-chat" class="btn-secondary" title="Clear chat">Clear</button>
                </div>

                <div class="chat-messages" id="chat-messages">
                    <div class="message system">
                        <div class="message-content">
                            <p>Welcome! Describe the 3D model you want to create.</p>
                            <p><strong>Examples:</strong></p>
                            <ul>
                                <li>"Create a cube with 5mm sides and a 3mm hole in the middle"</li>
                                <li>"A cylinder with 10mm radius and 30mm height"</li>
                                <li>"A rounded rectangular box 40x20x15mm with 3mm fillets"</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="chat-input-container">
                    <textarea
                        id="chat-input"
                        placeholder="Describe your 3D model..."
                        rows="3"
                    ></textarea>
                    <button id="send-btn" class="btn-primary">
                        <span>Generate</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                        </svg>
                    </button>
                </div>

                <!-- Syntax Reference Panel -->
                <div class="reference-panel" id="reference-panel">
                    <div class="reference-header" id="reference-toggle">
                        <h3>CadQuery Syntax Reference</h3>
                        <svg class="chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="reference-content" id="reference-content">
                        <div class="reference-section">
                            <h4>Basic Shapes</h4>
                            <ul>
                                <li><code>box(L, W, H)</code> - rectangular box</li>
                                <li><code>cylinder(height, radius)</code> - cylinder</li>
                                <li><code>sphere(radius)</code> - sphere</li>
                            </ul>
                        </div>
                        <div class="reference-section">
                            <h4>Face Selection</h4>
                            <ul>
                                <li><code>.faces("&gt;Z")</code> - top face</li>
                                <li><code>.faces("&lt;Z")</code> - bottom face</li>
                                <li><code>.faces("&gt;X")</code> - front face</li>
                                <li><code>.faces("&lt;X")</code> - back face</li>
                                <li><code>.faces("&gt;Y")</code> - right face</li>
                                <li><code>.faces("&lt;Y")</code> - left face</li>
                            </ul>
                        </div>
                        <div class="reference-section">
                            <h4>Edge Selection</h4>
                            <ul>
                                <li><code>.edges()</code> - all edges</li>
                                <li><code>.edges("|Z")</code> - edges parallel to Z</li>
                                <li><code>.edges("&gt;Z")</code> - top edges</li>
                                <li><code>.edges("&lt;Z")</code> - bottom edges</li>
                            </ul>
                        </div>
                        <div class="reference-section">
                            <h4>Operations</h4>
                            <ul>
                                <li><code>.hole(diameter)</code> - through hole</li>
                                <li><code>.hole(diameter, depth)</code> - blind hole</li>
                                <li><code>.fillet(radius)</code> - round edges</li>
                                <li><code>.chamfer(distance)</code> - bevel edges</li>
                                <li><code>.shell(thickness)</code> - hollow out</li>
                                <li><code>.extrude(height)</code> - extrude sketch</li>
                                <li><code>.cut(shape)</code> - subtract shape</li>
                                <li><code>.union(shape)</code> - add shape</li>
                            </ul>
                        </div>
                        <div class="reference-section">
                            <h4>Tips</h4>
                            <ul>
                                <li>Holes use <strong>diameter</strong>, not radius</li>
                                <li>Default units are <strong>millimeters</strong></li>
                                <li>Say "add fillet to all edges" or "fillet the top edges"</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Viewer Panel -->
            <div class="viewer-panel">
                <div class="panel-header">
                    <h2>3D Viewer</h2>
                    <div class="viewer-controls">
                        <button id="reset-view" class="btn-secondary" title="Reset camera view">Reset View</button>
                        <button id="download-step" class="btn-primary" title="Download STEP file" disabled>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            Download STEP
                        </button>
                    </div>
                </div>
                <div class="viewer-container" id="viewer-container">
                    <div class="viewer-placeholder" id="viewer-placeholder">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                            <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                            <line x1="12" y1="22.08" x2="12" y2="12"></line>
                        </svg>
                        <p>Your 3D model will appear here</p>
                    </div>
                    <canvas id="viewer-canvas"></canvas>
                </div>

                <!-- Feature List Panel -->
                <div class="feature-panel" id="feature-panel">
                    <div class="feature-header" id="feature-toggle">
                        <h3>Model Features</h3>
                        <svg class="chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="feature-content" id="feature-content">
                        <ul id="feature-list">
                            <li class="no-features">No model created yet</li>
                        </ul>
                        <p class="feature-tip">Reference these names when making modifications</p>
                    </div>
                </div>

                <!-- Code Panel (collapsible) -->
                <div class="code-panel" id="code-panel">
                    <div class="code-header" id="code-toggle">
                        <h3>Generated CadQuery Code</h3>
                        <svg class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="code-content" id="code-content">
                        <pre><code id="generated-code">No code generated yet</code></pre>
                        <button id="run-code" class="btn-secondary" disabled>Run Modified Code</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
        <p id="loading-text">Generating your 3D model...</p>
    </div>

    <script src="/static/js/viewer.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>
